<div class="container mt-4">
  <div>
    <%=better_time(Date.today) %>
  </div>
  <div>
    <strong><%=pluralize @nb_tasks_not_done, 'task'%></strong>,
    <strong><%=pluralize @nb_habits_not_done, 'habit'%></strong> remaining
  </div>
    <hr>
  <div>
  <% today = Date.today %>
    <%  case @opacity_coeff[today] %>
      <% when (0..0.35) %>
      <h3>Come on! ðŸ¤Œ <br> You've done only <%= "#{@done_tasks_per_day[today]}" %> tasks today! Better do more tomorrow! </h3>
      <% when (0.36..0.75) %>
      <h3>Good job! ðŸ’ª <br> You made <%= "#{(@opacity_coeff[today] * 100).to_i}%" %> of your tasks list! But you can do better! </h3>
      <% when (0.76..1) %>
      <h3> You rocked it! ðŸš€ <br> You made <%= "#{(@opacity_coeff[today] * 100).to_i}%" %> of your tasks list!</h3>
    <% end %>
  </div>
  <hr>
  <div class="mt-3">
    <p class="mb-3">Review your tasks before starting a new day <%@username%></p>
  </div>

<%= simple_form_for :reset, url: reset_path, method: :post do |f| %>
  <div class="list-container">
    <%#= hidden_field_tag 'mark_as_done_task_ids[]' %>
      <% @tasks.today.each do |task| %>
        <div class="task-box d-flex justify-content-between">
          <div>
            <%= check_box_tag 'mark_as_done_task_ids[]', task.id, task.mark_as_done, id: "mark_as_done_task_ids_#{task.id}", 'data-postpone-task-target': 'markAsDoneBtn' %>
            <%= label_tag "mark_as_done_task_ids_#{task.id}", task.name %>
          </div>
          <div class="d-flex" data-controller="postpone-task">
            <%= date_field_tag "postpone_task_date[#{task.id}", Date.tomorrow, min: Date.tomorrow.strftime("%Y-%m-%d"), class: "d-none", data: { postpone_task_target: 'calendar' } %>
            <div>
            <%= check_box_tag 'postpone_task_ids[]', task.id, @postponed, id: "postpone_task_ids_#{task.id}", class: "postpone-checkbox", 'data-action': "click->postpone-task#postpone", 'data-postpone-task-target': "postponeBtn"%>
            <%= label_tag "postpone_task_ids_#{task.id}", data: { action: 'click->postpone-task#toggleCalendar' } do %>
            <i class="fas fa-calendar"></i>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    <br>
    <br>

    <%= f.submit "New Day", class:"add-button next-day fixed-bottom", 'data-postpone-task-target': 'submitBtn', 'data-action': 'click->postpone-task#submit' %>
  <% end %>
</div>
